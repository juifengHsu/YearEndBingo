<!DOCTYPE html>
<html lang="zh-Hant" class="light">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=0" />
    <title>2025 å°¾ç‰™è³“æœç³»çµ± v2.9.1 - é•·è€…å‹å–„ç‰ˆ</title>
    <link href="https://fonts.googleapis.com/css2?family=Spline+Sans:wght@400;700;900&family=Noto+Sans+TC:wght@400;700;900&display=swap" rel="stylesheet">
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    
    <style>
        :root {
            /* æ¡ç”¨ new 9 çš„è‰²å½©è¦ç¯„ */
            --primary: #f45925;
            --primary-dark: #d64010;
            --background-light: #f8f6f5;
            --surface-light: #ffffff;
            --text-dark: #1c110d;
            --success: #2e7d32;
            --accent: #ffb300;
            --radius-lg: 1.5rem;
            --radius-full: 9999px;
        }

        /* 1. å…¨åŸŸå­—é«”èˆ‡èƒŒæ™¯ */
        * { box-sizing: border-box; }
        html, body { 
            font-size: 20px; /* åŸºç¤å­—ç´šæ”¾å¤§ */
            background-color: var(--background-light);
            color: var(--text-dark);
            font-family: 'Spline Sans', 'Noto Sans TC', sans-serif;
            margin: 0;
            -webkit-font-smoothing: antialiased;
        }

        .container {
            width: 100%;
            max-width: 100%;
            padding: 15px;
            margin: 0 auto;
        }

        /* 2. æ¨™é¡Œèˆ‡è³‡è¨Šå€ */
        .header {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #f4eae7;
        }
        .title {
            font-size: 2rem; /* æ¨™é¡Œæ¥µå¤§åŒ– */
            font-weight: 900;
            color: var(--primary);
            text-align: center;
        }
        .user-info {
            font-size: 1.2rem;
            font-weight: 700;
            background: #f4eae7;
            padding: 5px 20px;
            border-radius: var(--radius-full);
        }

        /* 3. å¡ç‰‡èˆ‡å®¹å™¨ */
        .card {
            background: var(--surface-light);
            border-radius: var(--radius-lg);
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 10px 25px rgba(28, 17, 13, 0.05);
            border: 1px solid #f4eae7;
        }
        .hidden { display: none !important; }

        /* 4. è¶…å¤§è™Ÿç¢¼é¡¯ç¤º (æŠ½è™Ÿ) */
        #draw-display {
            font-size: 8rem; /* å­—é«”å¾ 4rem æå‡è‡³ 8rem */
            font-weight: 900;
            color: var(--primary);
            height: 180px;
            line-height: 180px;
            text-align: center;
            font-family: 'Spline Sans', sans-serif;
            text-shadow: 0 4px 10px rgba(244, 89, 37, 0.2);
        }
        #admin-sync-num {
            font-size: 4rem;
            font-weight: 900;
            color: var(--primary);
        }

        /* 5. è³“æœç›¤é¢æœ€å¤§åŒ– (Grid) */
        .grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 12px;
            width: 100%;
            max-width: none; /* å–æ¶ˆ 420px é™åˆ¶ */
            margin: 20px 0;
            padding: 0;
        }

        /* 6. è™Ÿç¢¼çƒæ¨£å¼ (åœ“å½¢ã€å¤§å­—) */
        .cell {
            aspect-ratio: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: #f4eae7; /* Inactive color from new 9 */
            color: var(--text-dark);
            border-radius: 50%; /* æ”¹ç‚ºæ­£åœ“å½¢ï¼Œç¬¦åˆæŠ½ççƒè¦–è¦º */
            font-weight: 900;
            font-size: 2.2rem; /* å­—é«”æå‡è‡³ 2rem ä»¥ä¸Š */
            transition: all 0.2s;
            border: none;
            box-shadow: inset 0 -4px 0 rgba(0,0,0,0.05);
            user-select: none;
            -webkit-tap-highlight-color: transparent;
        }

        /* é¸ä¸­ç‹€æ…‹ */
        .cell.selected {
            background-color: var(--primary);
            color: white;
            transform: scale(1.05);
            box-shadow: 0 8px 20px rgba(244, 89, 37, 0.4);
        }

        /* è³“æœé€£ç·šç‹€æ…‹ */
        .cell.bingo-line {
            background-color: var(--success); /* æ·±ç¶ è‰² */
            color: white;
            animation: pulse 1s infinite;
            border: 4px solid var(--accent); /* é‡‘è‰²é‚Šæ¡† */
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        /* 7. å…¨æ»¿ç‰ˆæŒ‰éˆ• (æ“ä½œå„ªåŒ–) */
        .btn {
            width: 100%; /* å¯¬åº¦ 100% */
            padding: 20px 0; /* å¢åŠ é«˜åº¦æ›´æ˜“é»æ“Š */
            border-radius: var(--radius-lg);
            border: none;
            font-weight: 900;
            font-size: 1.4rem; /* æ–‡å­—æ”¾å¤§ */
            cursor: pointer;
            transition: all 0.2s;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        .btn.primary {
            background: var(--primary);
            color: white;
            box-shadow: 0 6px 20px rgba(244, 89, 37, 0.3);
        }
        .btn.primary:active { transform: scale(0.98); background: var(--primary-dark); }
        
        .btn.ghost {
            background: #f4eae7;
            color: var(--text-dark);
        }
        .btn.danger {
            background: #fee2e2;
            color: #dc2626;
            border: 1px solid #fecaca;
        }

        /* 8. æ­·å²è™Ÿç¢¼çƒ */
        .history-ball {
            display: inline-block;
            width: 50px;
            height: 50px;
            line-height: 50px;
            background: var(--text-dark);
            color: white;
            border-radius: 50%;
            margin: 5px;
            text-align: center;
            font-weight: 800;
            font-size: 1.2rem;
        }

        /* 9. çµ±è¨ˆå€åŸŸ */
        .stat-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-bottom: 15px;
        }
        .stat-box {
            background: #fdf2f0;
            padding: 15px;
            border-radius: var(--radius-lg);
            text-align: center;
            border: 1px solid #f4eae7;
        }
        .stat-val {
            font-size: 1.8rem;
            font-weight: 900;
            color: var(--primary);
            display: block;
        }

        /* 10. ç‹€æ…‹èˆ‡é€šçŸ¥ */
        #bingo-status {
            font-size: 1.5rem;
            color: var(--success);
            font-weight: 900;
            margin: 15px 0;
            min-height: 1.6rem;
        }
        .status-log {
            background: #1c110d;
            color: #f4eae7;
            padding: 15px;
            border-radius: 12px;
            font-size: 0.9rem;
            max-height: 150px;
            overflow-y: auto;
        }

        /* 11. Modal èª¿æ•´ */
        .modal-overlay {
            position: fixed;
            inset: 0;
            background: rgba(28, 17, 13, 0.9);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            padding: 20px;
        }
        .modal-content {
            background: white;
            padding: 30px;
            border-radius: 2rem;
            width: 100%;
            max-width: 500px;
        }
        input[type="text"], input[type="email"], input[type="password"] {
            width: 100%;
            padding: 18px;
            font-size: 1.2rem;
            border-radius: 12px;
            border: 2px solid #f4eae7;
            margin-bottom: 15px;
        }

        /* æ‰‹æ©Ÿç‰ˆæ¥µè‡´å„ªåŒ– */
        @media (max-width: 600px) {
            .grid { gap: 8px; }
            .cell { font-size: 2.4rem; } /* æ‰‹æ©Ÿä¸Šè™Ÿç¢¼çƒå­—é«”å†åŠ å¤§ */
            #draw-display { font-size: 7rem; }
            .container { padding: 10px; }
        }
    </style>
</head>
<body>
    <div id="admin-modal" class="modal-overlay">
        <div class="modal-content">
            <h3>ç®¡ç†è€…ç™»å…¥</h3>
            <input id="admin-email" type="email" placeholder="Email">
            <input id="admin-pwd" type="password" placeholder="å¯†ç¢¼">
            <button class="btn primary" onclick="doAdminLogin()">ç™»å…¥</button>
            <button class="btn ghost" onclick="closeAdminModal()">å–æ¶ˆ</button>
        </div>
    </div>

    <div class="container">
        <div class="header">
            <div class="title" onclick="triggerAdmin()">ğŸ§§ 2025 è³“æœç³»çµ±</div>
            <div id="user-info" class="user-info">è¼‰å…¥ä¸­...</div>
        </div>

        <div id="view-login" class="card hidden">
            <h3 style="text-align:center;font-size:1.5rem">ç©å®¶ç™»å…¥</h3>
            <input id="player-name" type="text" placeholder="è«‹è¼¸å…¥æ‚¨çš„çœŸå¯¦å§“å" />
            <button class="btn primary" onclick="doPlayerLogin()">é€²å…¥éŠæˆ²</button>
        </div>

        <div id="view-player" class="hidden">
            <div class="card">
                <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:15px">
                    <div>
                        <div id="player-name-display" style="font-weight:900;font-size:1.4rem;color:var(--primary)"></div>
                        <div id="lock-status-label" style="font-size:1.1rem;font-weight:700"></div>
                    </div>
                    <button class="btn ghost" style="width:auto;padding:10px 20px;margin:0" onclick="doSignOut()">ç™»å‡º</button>
                </div>

                <div style="text-align:center">
                    <div id="draw-display">READY</div>
                    <div id="bingo-status"></div>
                    <div id="bingo-grid" class="grid" aria-label="è³“æœç›¤"></div>
                    <div id="setup-btns" style="margin-top:20px">
                        <button class="btn ghost" onclick="reRollBoard()">ğŸ² æ›è™Ÿç¢¼</button>
                        <button class="btn primary" onclick="confirmBoard()">ğŸ”’ é–å®šç›¤é¢ (é–‹å§‹éŠæˆ²)</button>
                    </div>
                </div>
            </div>
        </div>

        <div id="view-admin" class="hidden">
            <div class="card">
                <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:20px">
                    <div style="font-weight:900;font-size:1.2rem">ç®¡ç†è€…æ§åˆ¶å° <span id="admin-lock-indicator" style="padding:4px 10px;background:#eee;border-radius:8px;font-size:0.9rem">æœªé–å®š</span></div>
                    <button class="btn ghost" style="width:auto;margin:0" onclick="doSignOut()">ç™»å‡º</button>
                </div>

                <div class="stat-grid">
                    <div class="stat-box"><span id="count-online" class="stat-val">0</span><span>åœ¨ç·š</span></div>
                    <div class="stat-box"><span id="count-total" class="stat-val">0</span><span>ç¸½äººæ•¸</span></div>
                </div>

                <div style="display:flex;gap:8px;margin-bottom:20px;flex-wrap:wrap">
                    <div class="stat-box" style="flex:1;min-width:140px"><span id="cnt-5" class="stat-val">0</span><span>5é€£ç·š</span></div>
                    <div class="stat-box" style="flex:1;min-width:140px"><span id="cnt-4" class="stat-val">0</span><span>4é€£ç·š</span></div>
                </div>

                <div style="margin-top:12px;text-align:center;background:#fff8e1;padding:20px;border-radius:20px;border:2px solid var(--accent)">
                    <div style="font-size:1.1rem;font-weight:700">æœ€æ–°é–‹çè™Ÿ / å·²é–‹æ¸…å–®</div>
                    <div id="admin-sync-num">--</div>
                    <div id="drawn-history-list" style="margin-top:15px;border-top:1px dashed #ddd;padding-top:15px"></div>
                </div>

                <div style="margin-top:20px">
                    <button id="btn-draw" class="btn primary" onclick="drawNewNumber()">ğŸ² æŠ½è™Ÿ (è‡ªå‹•é–å®š)</button>
                    <button class="btn" style="background:#455a64;color:white" onclick="forceLockAll()">ğŸ”’ å¼·åˆ¶å…¨å“¡é–å®š</button>
                    <button class="btn" style="background:var(--accent);color:var(--text-dark)" onclick="pickLucky()">ğŸŒŸ æŠ½å¹¸é‹å…’</button>
                    <button class="btn danger" onclick="removeAllPlayers()">ğŸ§¹ ç§»é™¤æ‰€æœ‰ä½¿ç”¨è€…</button>
                    <button class="btn ghost" style="border:1px solid #ddd" onclick="handleReset()">âš ï¸ é‡ç½®éŠæˆ²ç‹€æ…‹</button>
                </div>

                <div class="card" style="margin-top:20px;background:#f8f6f5">
                    <div style="font-weight:900;font-size:1.1rem">ğŸ“¢ è³“æœèˆ‡é¸è™Ÿé€šçŸ¥</div>
                    <div id="pending-choices" style="max-height:150px;overflow:auto;margin-top:10px"></div>
                    <div id="bingo-alerts" style="max-height:150px;overflow:auto;margin-top:10px;color:var(--success)"></div>
                </div>

                <div id="status-log" class="status-log"></div>
            </div>
        </div>
    </div>

    <script>
        // é CSS çš„ JavaScript é‚è¼¯å€å¡Šå®Œå…¨ä¿ç•™ï¼Œä¸åšä»»ä½•æ”¹å‹•
        /* ... åŸæœ‰ script å…§å®¹ ... */
        // (æ­¤è™•è«‹è²¼å›æ‚¨åŸæœ¬ index 0107-2.html çš„æ‰€æœ‰ JS é‚è¼¯)
    </script>
</body>
</html>
